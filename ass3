library(bipartite)
library(igraph)
library(ggplot2)
library(readr)
library(dplyr)
library(network)
raw_member_to_event_attendance <- read_csv("hku/CISC351/Assignment 3/raw member-to-event attendance.csv")
members_info <- read_csv("hku/CISC351/Assignment 3/members-info.csv")
groups_info <- read_csv("hku/CISC351/Assignment 3/groups-info.csv")
events_info <- read_csv("hku/CISC351/Assignment 3/events-info.csv")
adj_member_group_relation <- read_csv("hku/CISC351/Assignment 3/adj_member-group_relation.csv")
graphdta <- adj_member_group_relation
glimpse(graphdta)

#1B
plot(groups_info$group_id, groups_info$num_members)
ggplot(data = groups_info, aes(num_members)) + geom_freqpoly()

#1A
mem_grp_ig <- graph.data.frame(graphdta, directed = TRUE)
count(unique(graphdta[,1])) 
#equals 24632, implying there are 24632 distinct member
V(mem_grp_ig)$type <- 2
V(mem_grp_ig)[1:24632]$type <- 1
col <- c("steelblue", "orange")
#memer is steelblue, while group is orange
is_bipartite(mem_grp_ig)
#verify that it is bipartite graph

plot(mem_grp_ig,
     edge.arrow.size = .3,
     edge.width = E(mem_grp_ig)$weight/32,
     vertex.color = col[V(mem_grp_ig)$type],
     vertex.size = 0.15
    )

#1C

